<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Gamified Productivity LocalStorage</title>
<style>
  body {
    font-family: Arial;
    background: linear-gradient(to bottom, #a1c4fd, #c2e9fb);
    display: flex; flex-direction: column; align-items: center; padding: 30px; overflow-x:hidden;
  }
  #dashboard {
    background: rgba(255,255,255,0.95);
    border-radius: 20px; padding:30px; width:450px;
    box-shadow: 0 8px 20px rgba(0,0,0,0.3); text-align:center; position: relative;
  }
  #pet-face {
    font-size: 80px; display:inline-block; transition: transform 0.3s, all 0.3s;
  }
  button { margin:5px; padding:10px 20px; border-radius:10px; border:none; cursor:pointer;
           background-color:#ff8c42; color:white; font-size:16px; transition: transform 0.1s, background 0.2s; }
  button:hover { transform: scale(1.1); background-color:#ff7330; }
  input, select { width:70%; padding:8px; margin:5px 0; border-radius:8px; border:1px solid #ccc; }
  .habit-item { display:flex; justify-content:space-between; align-items:center; margin:5px 0; }
  .progress-bar { width:100%; background:#ddd; border-radius:8px; overflow:hidden; height:12px; margin:5px 0; }
  .progress { height:100%; background:#ff8c42; width:0%; transition: width 0.5s; }
  hr { margin:20px 0; }
  .confetti { position:absolute; width:10px; height:10px; animation: fall 3s linear forwards; }
  @keyframes fall { 0% { transform:translateY(0) rotate(0deg); } 100% { transform:translateY(500px) rotate(720deg); opacity:0; } }
</style>
</head>
<body>

<div id="dashboard">
  <h2 id="user-name">Welcome!</h2>
  <div id="pet-face">üê∂</div>

  <!-- Pet Customization -->
  <h3>Customize Your Pet</h3>
  <div>
    <select id="pet-select">
      <option value="üê∂">Dog</option>
      <option value="üê±">Cat</option>
      <option value="ü¶ä">Fox</option>
      <option value="üêº">Panda</option>
      <option value="üê∏">Frog</option>
    </select>
    <input type="color" id="pet-color" value="#ffcc00">
    <button onclick="savePetCustomization()">Save</button>
  </div>

  <hr>

  <!-- HABIT TRACKER -->
  <h3>Habits</h3>
  <div>
    <input type="text" id="new-habit" placeholder="Add new habit">
    <button onclick="addHabit()">‚ûï</button>
  </div>
  <div id="habit-list"></div>
  <div class="progress-bar"><div id="habit-progress" class="progress"></div></div>

  <hr>

  <!-- POMODORO TIMER -->
  <h3>Pomodoro Timer</h3>
  <div>
    <div id="timer-display">25:00</div>
    <button onclick="startPomodoro()">Start</button>
    <button onclick="stopPomodoro()">Stop</button>
  </div>
  <div class="progress-bar"><div id="pomodoro-progress" class="progress"></div></div>

  <hr>

  <!-- MOOD TRACKER -->
  <h3>Mood Tracker</h3>
  <div>
    <button onclick="setMood('üòä')">üòä Happy</button>
    <button onclick="setMood('üòê')">üòê Neutral</button>
    <button onclick="setMood('üò¢')">üò¢ Sad</button>
  </div>
  <div id="mood-history"></div>

  <hr>

  <div id="message">Take care of your habits and your pet!</div>
  <button onclick="resetAllData()">Reset All Data</button>
</div>

<script>
const habitListEl=document.getElementById("habit-list");
const petFace=document.getElementById("pet-face");
const messageEl=document.getElementById("message");
const moodHistoryEl=document.getElementById("mood-history");
const habitProgressEl=document.getElementById("habit-progress");
const pomodoroProgressEl=document.getElementById("pomodoro-progress");

let pomodoroTime=25*60; let pomodoroInterval=null;

// ---------- LOCAL STORAGE HELPERS ----------
function saveToStorage(key,value){ localStorage.setItem(key, JSON.stringify(value)); }
function loadFromStorage(key,defaultVal){ return JSON.parse(localStorage.getItem(key)) || defaultVal; }

// ---------- PET CUSTOMIZATION ----------
function savePetCustomization(){
  const emoji=document.getElementById("pet-select").value;
  const color=document.getElementById("pet-color").value;
  saveToStorage("pet", {emoji,color});
  updatePetEmoji(emoji,color);
}
function loadPetCustomization(){
  const pet=loadFromStorage("pet",{emoji:"üê∂",color:"#ffcc00"});
  document.getElementById("pet-select").value=pet.emoji;
  document.getElementById("pet-color").value=pet.color;
  updatePetEmoji(pet.emoji,pet.color);
}
function updatePetEmoji(emoji,color){
  petFace.innerText=emoji;
  petFace.style.background=color;
  petFace.style.borderRadius="50%"; petFace.style.padding="10px";
}

// ---------- HABITS ----------
function addHabit(){
  const name=document.getElementById("new-habit").value.trim();
  if(!name) return;
  const habits=loadFromStorage("habits",[]);
  habits.push({name,done:false,streak:0,lastCompleted:null});
  saveToStorage("habits",habits);
  document.getElementById("new-habit").value="";
  loadHabits();
}

function loadHabits(){
  habitListEl.innerHTML="";
  const habits=loadFromStorage("habits",[]);
  habits.forEach((habit,i)=>{
    const div=document.createElement("div");
    div.className="habit-item";
    div.innerHTML=`<span>${habit.name} (Streak: ${habit.streak})</span>
                   <button onclick="toggleHabit(${i})">${habit.done?"‚úÖ":"‚¨ú"}</button>`;
    habitListEl.appendChild(div);
  });
  updateHabitProgress(habits);
  updatePetFace(habits);
}

function toggleHabit(index){
  const habits=loadFromStorage("habits",[]);
  const today=new Date().toDateString();
  const habit=habits[index];
  if(!habit.done && habit.lastCompleted!==today) habit.streak++;
  habit.done=!habit.done;
  habit.lastCompleted=habit.done?today:habit.lastCompleted;
  saveToStorage("habits",habits);
  animatePet(); checkCelebrate(habits); loadHabits();
}

function updateHabitProgress(habits){
  const total=habits.length;
  const doneCount=habits.filter(h=>h.done).length;
  habitProgressEl.style.width=total? (doneCount/total*100)+"%":"0%";
}

// ---------- POMODORO ----------
function startPomodoro(){
  if(pomodoroInterval) return;
  let time=pomodoroTime;
  pomodoroInterval=setInterval(()=>{
    const min=Math.floor(time/60); const sec=time%60;
    document.getElementById("timer-display").innerText=`${min.toString().padStart(2,"0")}:${sec.toString().padStart(2,"0")}`;
    if(time===0){ clearInterval(pomodoroInterval); pomodoroInterval=null; messageEl.innerText="Pomodoro complete! üéâ"; animatePet(); launchConfetti(); }
    time--;
  },1000);
}
function stopPomodoro(){ clearInterval(pomodoroInterval); pomodoroInterval=null; }

// ---------- MOOD ----------
function setMood(mood){
  const moods=loadFromStorage("moods",[]);
  moods.unshift({mood,date:new Date().toDateString()});
  if(moods.length>7) moods.pop();
  saveToStorage("moods",moods);
  loadMoodHistory();
  animatePet(); launchConfetti();
}
function loadMoodHistory(){
  moodHistoryEl.innerHTML="";
  const moods=loadFromStorage("moods",[]);
  moods.forEach(m=>{ const div=document.createElement("div"); div.innerText=`${m.date}: ${m.mood}`; moodHistoryEl.appendChild(div); });
}

// ---------- PET ANIMATION & CONFETTI ----------
function animatePet(){
  petFace.style.transform="translateY(-20px) rotate(15deg)";
  setTimeout(()=>{ petFace.style.transform="translateY(0px) rotate(0deg)"; },400);
}

function checkCelebrate(habits){
  if(habits.length && habits.every(h=>h.done)) launchConfetti();
  if(habits.some(h=>h.streak>=5)) launchConfetti();
}

function launchConfetti(){
  for(let i=0;i<30;i++){
    const c=document.createElement("div"); c.className="confetti";
    c.style.left=Math.random()*430+"px"; c.style.background=`hsl(${Math.random()*360},100%,50%)`;
    document.getElementById("dashboard").appendChild(c);
    setTimeout(()=>c.remove(),3000);
  }
}

// ---------- RESET DATA ----------
function resetAllData(){
  if(confirm("Are you sure you want to delete all data?")){
    localStorage.clear(); loadHabits(); loadMoodHistory(); loadPetCustomization();
  }
}

// ---------- INIT ----------
loadPetCustomization();
loadHabits();
loadMoodHistory();
</script>
</body>
</html>
